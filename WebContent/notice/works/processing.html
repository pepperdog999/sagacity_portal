<div class="com-member-listBox" id="noticeList">
                        
	 <!-- Start of list -->
	 
	 <!-- End of list -->
	        
</div>
<div  class="com-member-list-page"><span><a onclick="pageLast()" class="last"><i></i></a><b id="pageInfo"><em>0</em>/0</b><a onclick="pageNext()" class="next"><i></i></a></span><font><input name="" type="text" /><a>跳转</a></font></div>
<script type="text/javascript">	

	var pageNumber=1;
	var pageSize=5;
	var totalPage=1;

	$(function() {
		 getNoticeList();
	});
	
	function getNoticeList(){
		$.ajax({
            url: "../notice/getProcessingList",
            type: "GET",
            dataType: "json",
            data: {
            	pageNumber: pageNumber,
				pageSize: pageSize
            	},
            success: function(data) {				
				//初始化框架
				var initNoticeDate=data.list[0].NoticeDate;
				var init=0;
				createFrame(init,initNoticeDate);				
				for(var i=0;i<data.list.length;i++){
					var noticeDate=data.list[i].NoticeDate;
					if(noticeDate != initNoticeDate){  //此数据的日期不存在
						init++;
						createFrame(init,noticeDate);
						initNoticeDate=noticeDate;
					}
				}
				
				//写入数据
				for(var i=0;i<data.list.length;i++){
					var noticeList='';
					noticeList+='<li onclick="noticeDetail(this)" noticeID="'+data.list[i].NoticeID+'">';
					noticeList+='<p class="list-time"><span>'+data.list[i].NoticeTime+'</span><font><a onclick="noticeDetail(this)">查看</a>|<a>置为重要</a>|<a>置为完成</a></font></p>';
					noticeList+='<p class="list-del">';
					if(data.list[i].blnEnd == 0){
						noticeList+='<img src="lib/images/unread.png">';
					}
					noticeList+='<a>'+data.list[i].NoticeTitle+'</a></p>';
					noticeList+='<p class="list-user">来源：<em>'+data.list[i].CreateSource+'</em></p>';
					if(data.list[i].SourceType == 0){
						noticeList+='<p class="list-source"><s><img src="lib/images/user.png" title="来自个人提醒"/></s></p>';
					}else if(data.list[i].SourceType == 1){
						noticeList+='<p class="list-source"><s><img src="lib/images/discovery.png" title="来自发现"/></s></p>';
					}else if(data.list[i].SourceType == 11){
						noticeList+='<p class="list-source"><s><img src="lib/images/meeting.png" title="来自会议助手"/></s></p>';
					}
					noticeList+='</li>';
					var posID= "#nList_"+data.list[i].NoticeDate;
					$(posID).append(noticeList);
				}
				
            	//分页信息
            	totalPage = data.totalPage;
            	pageNumber = data.pageNumber;
            	var pageInfo = '<em>'+data.pageNumber+'</em>/'+data.totalPage;
				$("#pageInfo").html(pageInfo);
            },
           	error: function (jqXHR, textStatus, errorThrown) {
                alert(jqXHR.responseText);
            }
        });
	}
	
	function createFrame(init,showDate){
		var d = new Date(showDate).getDay();
		if(d==0){
			d = '星期日';
		}else{
			d = '星期'+d;
		}
		var dd = new Date(showDate).dateDiff('d',new Date());
		if(dd>0){
			dd = '已过'+dd+'天';
		}else if(dd<0){
			dd = '还有'+Math.abs(dd)+'天';
		}else if(dd==0){
			dd = '今天';
		}
		var id = "nList_"+showDate;
		var frameHtml='';
		frameHtml+='<div class="com-lo">';
		frameHtml+='<table width="100%" border="0" cellspacing="0" cellpadding="0">';
		frameHtml+='<tr>';
		frameHtml+='<td align="left" valign="top" width="120"><div class="com-lo-l"><p class="date"><b>'+d+'</b><em>'+showDate.substr(0,4)+'日</em></p><p class="day">'+showDate.substr(8,2)+'&nbsp;<em>'+showDate.substr(5,2)+'月</em></p><p class="week"><i>'+dd+'</i></p></div></td>';
		frameHtml+='<td align="left" valign="top"><div class="com-lo-c"><ul class="com-member-list" id="'+id+'"></ul></div></td>';
		frameHtml+='</tr></table></div>';
		if(init==0){
			$("#noticeList").html(frameHtml);
		}else{
			$("#noticeList").append(frameHtml);	
		}
	}
	
	function pageNext(){
		if(pageNumber>=totalPage)
			return;
		pageNumber++;
		getNoticeList();
	}
	
	function pageLast(){
		if(pageNumber<=1)
			return;			
		pageNumber--;
		getNoticeList();
	}
	
	function noticeDetail(obj){
		event.stopPropagation();
		var noticeID;
		if(obj.tagName=="A"){
			noticeID=$(obj).parent().parent().parent().attr("noticeID");
		}else if(obj.tagName=="LI"){
			noticeID=$(obj).attr("noticeID");
		}
		window.alert(noticeID);
		
	}
	
	Date.prototype.dateDiff = function(interval,objDate2)   
	{   
	    var d=this, i={}, t=d.getTime(), t2=objDate2.getTime();   
	    i['y']=objDate2.getFullYear()-d.getFullYear();   
	    i['q']=i['y']*4+Math.floor(objDate2.getMonth()/4)-Math.floor(d.getMonth()/4);   
	    i['m']=i['y']*12+objDate2.getMonth()-d.getMonth();   
	    i['ms']=objDate2.getTime()-d.getTime();   
	    i['w']=Math.floor((t2+345600000)/(604800000))-Math.floor((t+345600000)/(604800000));   
	    i['d']=Math.floor(t2/86400000)-Math.floor(t/86400000);   
	    i['h']=Math.floor(t2/3600000)-Math.floor(t/3600000);   
	    i['n']=Math.floor(t2/60000)-Math.floor(t/60000);   
	    i['s']=Math.floor(t2/1000)-Math.floor(t/1000);   
	    return i[interval];   
	} 
</script>